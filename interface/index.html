<!DOCTYPE html>
<html>
	<head>
		<script src="/socket.io/socket.io.js"></script>
		<script>
		var socketio;

		var mouseDownCurrently = false;
		var sliderControl, oldSliderValue;

		function mouseDownToggle()
		{
			mouseDownCurrently = !mouseDownCurrently;
			sendMouseUpdates();
		}

		function sendMouseUpdates()
		{
			if(mouseDownCurrently == true)
			{
				//Only hassle the socket connection if there is a change in value!
				if(sliderControl.value != oldSliderValue)
				{
					console.log("Sending steering update: " + sliderControl.value);

					//Send Value
					socketio.emit("update_servo_value", sliderControl.value );

					//Update old slider value
					oldSliderValue = sliderControl.value;
				}
				setTimeout(sendMouseUpdates, 10, 1)
			}
		}

		function btnPressed()
		{
			console.log("Sending request to socket!");
			var sendData = document.getElementById("textBox").value;
			console.log("Value in text box to send: " + sendData);
			socketio.emit("btn_pressed", {DummyData : sendData});
		}

		window.onload = function()
		{
			socketio = io.connect("192.168.178.47:13378");

			socketio.on("return_data", function(data)
			{
				console.log("Server said: " + data["ServoValue"]);
				console.log("Server said: " + data["Temp"]);
				console.log("Server said: " + data);
			});

			//Mouse functions for the servo controller
			sliderControl =	document.getElementById("steeringSlider");
			san = "Test";
			console.log(san);
			console.log(sliderControl.value);
		}
		</script>
	</head>

	<body>
		<input id="textBox"> </input>
		<button id="testBtn" onClick="btnPressed()">Click Me</button>

		<div align="right">

		</div>

		<div id="controls" width="800">
			<input type="range" id="steeringSlider" min="0" max="100" onmousedown="mouseDownToggle()" onmouseup="mouseDownToggle()">

		</div>
	</body>
</html>
